-- check scriptserver enabled
select * from SYS.M_SERVICES;

-- check PAL functions available
select * from SYS.AFL_FUNCTIONS where PACKAGE_NAME='PAL' and FUNCTION_NAME like '%_ANY';

-- check APL functions available
select * from SYS.AFL_FUNCTIONS where PACKAGE_NAME='APL';

-- create and grant roles to user
create user MYUSER password <password> NO FORCE_FIRST_PASSWORD_CHANGE;
grant AFL__SYS_AFL_AFLPAL_EXECUTE to MYUSER;
grant "sap.pa.apl.base.roles::APL_EXECUTE" to MYUSER;

-- create cache for APL
create schema APL_CACHE;
grant create any on schema APL_CACHE to MYUSER;

-- set up data
create schema MYDATA;
grant select on schema MYDATA to MYUSER;

create column table MYDATA."OzoneRate" (
    "Id" INTEGER NOT NULL,
    "Date" DATE,
    "OzoneRate" DOUBLE
);

insert into MYDATA."OzoneRate" values (1,'1955/01/28',2.63);
insert into MYDATA."OzoneRate" values (2,'1955/02/28',1.94);
insert into MYDATA."OzoneRate" values (3,'1955/03/28',3.38);
insert into MYDATA."OzoneRate" values (4,'1955/04/28',4.92);
insert into MYDATA."OzoneRate" values (5,'1955/05/28',6.29);
insert into MYDATA."OzoneRate" values (6,'1955/06/28',5.58);
insert into MYDATA."OzoneRate" values (7,'1955/07/28',5.5);
insert into MYDATA."OzoneRate" values (8,'1955/08/28',4.71);
insert into MYDATA."OzoneRate" values (9,'1955/09/28',6.04);
insert into MYDATA."OzoneRate" values (10,'1955/10/28',7.13);
insert into MYDATA."OzoneRate" values (11,'1955/11/28',7.79);
insert into MYDATA."OzoneRate" values (12,'1955/12/28',3.83);
insert into MYDATA."OzoneRate" values (13,'1956/01/28',3.83);
insert into MYDATA."OzoneRate" values (14,'1956/02/28',4.25);
insert into MYDATA."OzoneRate" values (15,'1956/03/28',5.29);
insert into MYDATA."OzoneRate" values (16,'1956/04/28',3.75);
insert into MYDATA."OzoneRate" values (17,'1956/05/28',4.67);
insert into MYDATA."OzoneRate" values (18,'1956/06/28',5.42);
insert into MYDATA."OzoneRate" values (19,'1956/07/28',6.04);
insert into MYDATA."OzoneRate" values (20,'1956/08/28',5.71);
insert into MYDATA."OzoneRate" values (21,'1956/09/28',8.13);
insert into MYDATA."OzoneRate" values (22,'1956/10/28',4.88);
insert into MYDATA."OzoneRate" values (23,'1956/11/28',5.42);
insert into MYDATA."OzoneRate" values (24,'1956/12/28',5.5);
insert into MYDATA."OzoneRate" values (25,'1957/01/28',3);
insert into MYDATA."OzoneRate" values (26,'1957/02/28',3.42);
insert into MYDATA."OzoneRate" values (27,'1957/03/28',4.5);
insert into MYDATA."OzoneRate" values (28,'1957/04/28',4.25);
insert into MYDATA."OzoneRate" values (29,'1957/05/28',4);
insert into MYDATA."OzoneRate" values (30,'1957/06/28',5.33);
insert into MYDATA."OzoneRate" values (31,'1957/07/28',5.79);
insert into MYDATA."OzoneRate" values (32,'1957/08/28',6.58);
insert into MYDATA."OzoneRate" values (33,'1957/09/28',7.29);
insert into MYDATA."OzoneRate" values (34,'1957/10/28',5.04);
insert into MYDATA."OzoneRate" values (35,'1957/11/28',5.04);
insert into MYDATA."OzoneRate" values (36,'1957/12/28',4.48);
insert into MYDATA."OzoneRate" values (37,'1958/01/28',3.33);
insert into MYDATA."OzoneRate" values (38,'1958/02/28',2.88);
insert into MYDATA."OzoneRate" values (39,'1958/03/28',2.5);
insert into MYDATA."OzoneRate" values (40,'1958/04/28',3.83);
insert into MYDATA."OzoneRate" values (41,'1958/05/28',4.17);
insert into MYDATA."OzoneRate" values (42,'1958/06/28',4.42);
insert into MYDATA."OzoneRate" values (43,'1958/07/28',4.25);
insert into MYDATA."OzoneRate" values (44,'1958/08/28',4.08);
insert into MYDATA."OzoneRate" values (45,'1958/09/28',4.88);
insert into MYDATA."OzoneRate" values (46,'1958/10/28',4.54);
insert into MYDATA."OzoneRate" values (47,'1958/11/28',4.25);
insert into MYDATA."OzoneRate" values (48,'1958/12/28',4.21);
insert into MYDATA."OzoneRate" values (49,'1959/01/28',2.75);
insert into MYDATA."OzoneRate" values (50,'1959/02/28',2.42);
insert into MYDATA."OzoneRate" values (51,'1959/03/28',4.5);
insert into MYDATA."OzoneRate" values (52,'1959/04/28',5.21);
insert into MYDATA."OzoneRate" values (53,'1959/05/28',4);
insert into MYDATA."OzoneRate" values (54,'1959/06/28',7.54);
insert into MYDATA."OzoneRate" values (55,'1959/07/28',7.38);
insert into MYDATA."OzoneRate" values (56,'1959/08/28',5.96);
insert into MYDATA."OzoneRate" values (57,'1959/09/28',5.08);
insert into MYDATA."OzoneRate" values (58,'1959/10/28',5.46);
insert into MYDATA."OzoneRate" values (59,'1959/11/28',4.79);
insert into MYDATA."OzoneRate" values (60,'1959/12/28',2.67);
insert into MYDATA."OzoneRate" values (61,'1960/01/28',1.71);
insert into MYDATA."OzoneRate" values (62,'1960/02/28',1.92);
insert into MYDATA."OzoneRate" values (63,'1960/03/28',3.38);
insert into MYDATA."OzoneRate" values (64,'1960/04/28',3.98);
insert into MYDATA."OzoneRate" values (65,'1960/05/28',4.63);
insert into MYDATA."OzoneRate" values (66,'1960/06/28',4.88);
insert into MYDATA."OzoneRate" values (67,'1960/07/28',5.17);
insert into MYDATA."OzoneRate" values (68,'1960/08/28',4.83);
insert into MYDATA."OzoneRate" values (69,'1960/09/28',5.29);
insert into MYDATA."OzoneRate" values (70,'1960/10/28',3.71);
insert into MYDATA."OzoneRate" values (71,'1960/11/28',2.46);
insert into MYDATA."OzoneRate" values (72,'1960/12/28',2.17);
insert into MYDATA."OzoneRate" values (73,'1961/01/28',2.15);
insert into MYDATA."OzoneRate" values (74,'1961/02/28',2.44);
insert into MYDATA."OzoneRate" values (75,'1961/03/28',2.54);
insert into MYDATA."OzoneRate" values (76,'1961/04/28',3.25);
insert into MYDATA."OzoneRate" values (77,'1961/05/28',2.81);
insert into MYDATA."OzoneRate" values (78,'1961/06/28',4.21);
insert into MYDATA."OzoneRate" values (79,'1961/07/28',4.13);
insert into MYDATA."OzoneRate" values (80,'1961/08/28',4.17);
insert into MYDATA."OzoneRate" values (81,'1961/09/28',3.75);
insert into MYDATA."OzoneRate" values (82,'1961/10/28',3.83);
insert into MYDATA."OzoneRate" values (83,'1961/11/28',2.42);
insert into MYDATA."OzoneRate" values (84,'1961/12/28',2.17);
insert into MYDATA."OzoneRate" values (85,'1962/01/28',2.33);
insert into MYDATA."OzoneRate" values (86,'1962/02/28',2);
insert into MYDATA."OzoneRate" values (87,'1962/03/28',2.13);
insert into MYDATA."OzoneRate" values (88,'1962/04/28',4.46);
insert into MYDATA."OzoneRate" values (89,'1962/05/28',3.17);
insert into MYDATA."OzoneRate" values (90,'1962/06/28',3.25);
insert into MYDATA."OzoneRate" values (91,'1962/07/28',4.08);
insert into MYDATA."OzoneRate" values (92,'1962/08/28',5.42);
insert into MYDATA."OzoneRate" values (93,'1962/09/28',4.5);
insert into MYDATA."OzoneRate" values (94,'1962/10/28',4.88);
insert into MYDATA."OzoneRate" values (95,'1962/11/28',2.83);
insert into MYDATA."OzoneRate" values (96,'1962/12/28',2.75);
insert into MYDATA."OzoneRate" values (97,'1963/01/28',1.63);
insert into MYDATA."OzoneRate" values (98,'1963/02/28',3.04);
insert into MYDATA."OzoneRate" values (99,'1963/03/28',2.58);
insert into MYDATA."OzoneRate" values (100,'1963/04/28',2.92);
insert into MYDATA."OzoneRate" values (101,'1963/05/28',3.29);
insert into MYDATA."OzoneRate" values (102,'1963/06/28',3.71);
insert into MYDATA."OzoneRate" values (103,'1963/07/28',4.88);
insert into MYDATA."OzoneRate" values (104,'1963/08/28',4.63);
insert into MYDATA."OzoneRate" values (105,'1963/09/28',4.83);
insert into MYDATA."OzoneRate" values (106,'1963/10/28',3.42);
insert into MYDATA."OzoneRate" values (107,'1963/11/28',2.38);
insert into MYDATA."OzoneRate" values (108,'1963/12/28',2.33);
insert into MYDATA."OzoneRate" values (109,'1964/01/28',1.5);
insert into MYDATA."OzoneRate" values (110,'1964/02/28',2.25);
insert into MYDATA."OzoneRate" values (111,'1964/03/28',2.63);
insert into MYDATA."OzoneRate" values (112,'1964/04/28',2.96);
insert into MYDATA."OzoneRate" values (113,'1964/05/28',3.46);
insert into MYDATA."OzoneRate" values (114,'1964/06/28',4.33);
insert into MYDATA."OzoneRate" values (115,'1964/07/28',5.42);
insert into MYDATA."OzoneRate" values (116,'1964/08/28',4.79);
insert into MYDATA."OzoneRate" values (117,'1964/09/28',4.38);
insert into MYDATA."OzoneRate" values (118,'1964/10/28',4.54);
insert into MYDATA."OzoneRate" values (119,'1964/11/28',2.04);
insert into MYDATA."OzoneRate" values (120,'1964/12/28',1.33);
insert into MYDATA."OzoneRate" values (121,'1965/01/28',2.04);
insert into MYDATA."OzoneRate" values (122,'1965/02/28',2.81);
insert into MYDATA."OzoneRate" values (123,'1965/03/28',2.67);
insert into MYDATA."OzoneRate" values (124,'1965/04/28',4.08);
insert into MYDATA."OzoneRate" values (125,'1965/05/28',3.9);
insert into MYDATA."OzoneRate" values (126,'1965/06/28',3.96);
insert into MYDATA."OzoneRate" values (127,'1965/07/28',4.5);
insert into MYDATA."OzoneRate" values (128,'1965/08/28',5.58);
insert into MYDATA."OzoneRate" values (129,'1965/09/28',4.52);
insert into MYDATA."OzoneRate" values (130,'1965/10/28',5.88);
insert into MYDATA."OzoneRate" values (131,'1965/11/28',3.67);
insert into MYDATA."OzoneRate" values (132,'1965/12/28',1.79);
insert into MYDATA."OzoneRate" values (133,'1966/01/28',1.71);
insert into MYDATA."OzoneRate" values (134,'1966/02/28',1.92);
insert into MYDATA."OzoneRate" values (135,'1966/03/28',3.58);
insert into MYDATA."OzoneRate" values (136,'1966/04/28',4.4);
insert into MYDATA."OzoneRate" values (137,'1966/05/28',3.79);
insert into MYDATA."OzoneRate" values (138,'1966/06/28',5.52);
insert into MYDATA."OzoneRate" values (139,'1966/07/28',5.5);
insert into MYDATA."OzoneRate" values (140,'1966/08/28',5);
insert into MYDATA."OzoneRate" values (141,'1966/09/28',5.48);
insert into MYDATA."OzoneRate" values (142,'1966/10/28',4.81);
insert into MYDATA."OzoneRate" values (143,'1966/11/28',2.42);
insert into MYDATA."OzoneRate" values (144,'1966/12/28',1.46);
insert into MYDATA."OzoneRate" values (145,'1967/01/28',1.71);
insert into MYDATA."OzoneRate" values (146,'1967/02/28',2.46);
insert into MYDATA."OzoneRate" values (147,'1967/03/28',2.42);
insert into MYDATA."OzoneRate" values (148,'1967/04/28',1.79);
insert into MYDATA."OzoneRate" values (149,'1967/05/28',3.63);
insert into MYDATA."OzoneRate" values (150,'1967/06/28',3.54);
insert into MYDATA."OzoneRate" values (151,'1967/07/28',4.88);
insert into MYDATA."OzoneRate" values (152,'1967/08/28',4.96);
insert into MYDATA."OzoneRate" values (153,'1967/09/28',3.63);
insert into MYDATA."OzoneRate" values (154,'1967/10/28',5.46);
insert into MYDATA."OzoneRate" values (155,'1967/11/28',3.08);
insert into MYDATA."OzoneRate" values (156,'1967/12/28',1.75);
insert into MYDATA."OzoneRate" values (157,'1968/01/28',2.13);
insert into MYDATA."OzoneRate" values (158,'1968/02/28',2.58);
insert into MYDATA."OzoneRate" values (159,'1968/03/28',2.75);
insert into MYDATA."OzoneRate" values (160,'1968/04/28',3.15);
insert into MYDATA."OzoneRate" values (161,'1968/05/28',3.46);
insert into MYDATA."OzoneRate" values (162,'1968/06/28',3.33);
insert into MYDATA."OzoneRate" values (163,'1968/07/28',4.67);
insert into MYDATA."OzoneRate" values (164,'1968/08/28',4.13);
insert into MYDATA."OzoneRate" values (165,'1968/09/28',4.73);
insert into MYDATA."OzoneRate" values (166,'1968/10/28',3.42);
insert into MYDATA."OzoneRate" values (167,'1968/11/28',3.08);
insert into MYDATA."OzoneRate" values (168,'1968/12/28',1.79);
insert into MYDATA."OzoneRate" values (169,'1969/01/28',1.96);
insert into MYDATA."OzoneRate" values (170,'1969/02/28',1.63);
insert into MYDATA."OzoneRate" values (171,'1969/03/28',2.75);
insert into MYDATA."OzoneRate" values (172,'1969/04/28',3.06);
insert into MYDATA."OzoneRate" values (173,'1969/05/28',4.31);
insert into MYDATA."OzoneRate" values (174,'1969/06/28',3.31);
insert into MYDATA."OzoneRate" values (175,'1969/07/28',3.71);
insert into MYDATA."OzoneRate" values (176,'1969/08/28',5.25);
insert into MYDATA."OzoneRate" values (177,'1969/09/28',3.67);
insert into MYDATA."OzoneRate" values (178,'1969/10/28',3.1);
insert into MYDATA."OzoneRate" values (179,'1969/11/28',2.25);
insert into MYDATA."OzoneRate" values (180,'1969/12/28',2.29);
insert into MYDATA."OzoneRate" values (181,'1970/01/28',1.25);
insert into MYDATA."OzoneRate" values (182,'1970/02/28',2.25);
insert into MYDATA."OzoneRate" values (183,'1970/03/28',2.67);
insert into MYDATA."OzoneRate" values (184,'1970/04/28',3.23);
insert into MYDATA."OzoneRate" values (185,'1970/05/28',3.58);
insert into MYDATA."OzoneRate" values (186,'1970/06/28',3.04);
insert into MYDATA."OzoneRate" values (187,'1970/07/28',3.75);
insert into MYDATA."OzoneRate" values (188,'1970/08/28',4.54);
insert into MYDATA."OzoneRate" values (189,'1970/09/28',4.46);
insert into MYDATA."OzoneRate" values (190,'1970/10/28',2.83);
insert into MYDATA."OzoneRate" values (191,'1970/11/28',1.63);
insert into MYDATA."OzoneRate" values (192,'1970/12/28',1.17);
insert into MYDATA."OzoneRate" values (193,'1971/01/28',1.79);
insert into MYDATA."OzoneRate" values (194,'1971/02/28',1.92);
insert into MYDATA."OzoneRate" values (195,'1971/03/28',2.25);
insert into MYDATA."OzoneRate" values (196,'1971/04/28',2.96);
insert into MYDATA."OzoneRate" values (197,'1971/05/28',2.38);
insert into MYDATA."OzoneRate" values (198,'1971/06/28',3.38);
insert into MYDATA."OzoneRate" values (199,'1971/07/28',3.38);
insert into MYDATA."OzoneRate" values (200,'1971/08/28',3.21);
insert into MYDATA."OzoneRate" values (201,'1971/09/28',2.58);
insert into MYDATA."OzoneRate" values (202,'1971/10/28',2.42);
insert into MYDATA."OzoneRate" values (203,'1971/11/28',1.58);
insert into MYDATA."OzoneRate" values (204,'1971/12/28',1.21);
